---
layout: default
---

<div class="container mx-auto px-4 py-8">
  <!-- Page Header -->
  <div class="text-center mb-12">
    <h1 class="text-4xl md:text-5xl font-bold mb-4 text-primary [text-shadow:0_0_10px_currentColor]">
      {{ page.title }}
    </h1>
    {% if page.description %}
      <p class="text-lg text-base-content/80 max-w-2xl mx-auto">
        {{ page.description }}
      </p>
    {% endif %}
  </div>

  <!-- Filter and Display Options -->
  <div class="flex flex-col md:flex-row justify-between items-center gap-4 mb-8">
    <!-- Filter Options -->
    <div class="flex flex-wrap gap-2">
      {% if page.show_category_filter %}
        <div class="dropdown">
          <div tabindex="0" role="button" class="btn btn-outline btn-sm">
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
            </svg>
            Categories
          </div>
          <div tabindex="0" class="dropdown-content bg-base-100 rounded-box z-[1] w-60 p-2 shadow max-h-60 overflow-y-auto">
            <a href="{{ '/posts/' | relative_url }}" class="block px-4 py-2 text-sm hover:bg-base-200 rounded">All Categories</a>
            <div class="divider my-1"></div>
            {% assign sorted_categories = site.categories | sort %}
            {% for category in sorted_categories %}
              <a href="{{ '/posts/' | relative_url }}?category={{ category[0] | slugify }}" 
                 class="block px-4 py-2 text-sm hover:bg-base-200 rounded flex justify-between items-center">
                <span>{{ category[0] }}</span>
                <span class="badge badge-ghost badge-sm">{{ category[1].size }}</span>
              </a>
            {% endfor %}
          </div>
        </div>
      {% endif %}

      {% if page.show_tag_filter %}
        <div class="dropdown">
          <div tabindex="0" role="button" class="btn btn-outline btn-sm">
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
            </svg>
            Tags
          </div>
          <div tabindex="0" class="dropdown-content bg-base-100 rounded-box z-[1] w-60 p-2 shadow max-h-60 overflow-y-auto">
            <a href="{{ '/posts/' | relative_url }}" class="block px-4 py-2 text-sm hover:bg-base-200 rounded">All Tags</a>
            <div class="divider my-1"></div>
            {% assign sorted_tags = site.tags | sort %}
            {% for tag in sorted_tags %}
              <a href="{{ '/posts/' | relative_url }}?tag={{ tag[0] | slugify }}" 
                 class="block px-4 py-2 text-sm hover:bg-base-200 rounded flex justify-between items-center">
                <span>{{ tag[0] }}</span>
                <span class="badge badge-ghost badge-sm">{{ tag[1].size }}</span>
              </a>
            {% endfor %}
          </div>
        </div>
      {% endif %}
    </div>

    <!-- Display Options -->
    <div class="flex gap-2">
      <div class="join">
        <button class="btn join-item btn-sm btn-outline" id="grid-view" title="Grid View">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
          </svg>
        </button>
        <button class="btn join-item btn-sm btn-outline" id="list-view" title="List View">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"/>
          </svg>
        </button>
        <button class="btn join-item btn-sm btn-outline" id="timeline-view" title="Timeline View">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Posts Collection -->
  {% comment %}
  Determine which posts to show based on page configuration
  {% endcomment %}
  
  {% assign posts_to_show = site.posts %}
  
  {% if page.archive_type == "category" and page.archive_value %}
    {% assign posts_to_show = site.categories[page.archive_value] %}
  {% elsif page.archive_type == "tag" and page.archive_value %}
    {% assign posts_to_show = site.tags[page.archive_value] %}
  {% elsif page.archive_type == "year" and page.archive_value %}
    {% assign posts_to_show = site.posts | where_exp: "post", "post.date | date: '%Y' == page.archive_value" %}
  {% endif %}

  <!-- Posts Display Container -->
  <div id="posts-container">
    
    <!-- Grid View (Default) -->
    <div id="grid-posts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {% for post in posts_to_show limit: page.posts_per_page %}
        <article class="card bg-base-200 border border-primary/30 hover:shadow-[0_0_20px_rgba(0,255,255,0.5)] transition-all duration-300" 
                 data-post 
                 data-categories="{% if post.category %}{{ post.category | slugify }}{% endif %}"
                 data-tags="{% for tag in post.tags %}{{ tag | slugify }}{% unless forloop.last %} {% endunless %}{% endfor %}">
          <div class="card-body p-6">
            <h3 class="card-title text-lg font-bold mb-3 text-white line-clamp-2">
              <a href="{{ post.url | relative_url }}" class="hover:text-accent transition-colors">
                {{ post.title }}
              </a>
            </h3>
            
            <div class="flex items-center gap-4 text-sm text-base-content/60 mb-3">
              <div class="flex items-center gap-1">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                </svg>
                <span>{{ post.date | date: "%-m/%-d/%Y" }}</span>
              </div>
              <div class="flex items-center gap-1">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span>{{ post.content | strip_html | number_of_words | divided_by: 200 | plus: 1 }} min read</span>
              </div>
            </div>

            <p class="text-base-content/80 mb-4 text-sm line-clamp-3">
              {{ post.excerpt | default: post.content | strip_html | truncatewords: 20 }}
            </p>

            {% if post.tags and post.tags.size > 0 %}
            <div class="flex flex-wrap gap-1 mb-4">
              {% for tag in post.tags limit:3 %}
                <span class="badge badge-secondary badge-sm">{{ tag }}</span>
              {% endfor %}
              {% if post.tags.size > 3 %}
                <span class="text-xs text-base-content/60">+{{ post.tags.size | minus: 3 }} more</span>
              {% endif %}
            </div>
            {% endif %}

            <div class="card-actions justify-end">
              <a href="{{ post.url | relative_url }}" class="btn btn-primary btn-outline btn-sm group">
                <span>Read More</span>
                <svg class="w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                </svg>
              </a>
            </div>
          </div>
        </article>
      {% endfor %}
    </div>

    <!-- List View -->
    <div id="list-posts" class="space-y-4 hidden">
      {% for post in posts_to_show limit: page.posts_per_page %}
        <article class="card bg-base-100 shadow-xl" 
                 data-post 
                 data-categories="{% if post.category %}{{ post.category | slugify }}{% endif %}"
                 data-tags="{% for tag in post.tags %}{{ tag | slugify }}{% unless forloop.last %} {% endunless %}{% endfor %}">
          <div class="card-body p-6 flex-row items-center">
            <div class="flex-1">
              <h3 class="text-lg font-bold text-primary mb-2">
                <a href="{{ post.url | relative_url }}" class="hover:text-accent transition-colors">
                  {{ post.title }}
                </a>
              </h3>
              <div class="flex items-center gap-4 text-sm text-base-content/60 mb-2">
                <span>{{ post.date | date: "%B %d, %Y" }}</span>
                <span>{{ post.content | strip_html | number_of_words | divided_by: 200 | plus: 1 }} min read</span>
                {% if post.category %}
                  <span class="badge badge-outline badge-sm">{{ post.category }}</span>
                {% endif %}
              </div>
              <p class="text-base-content/80 text-sm">
                {{ post.excerpt | default: post.content | strip_html | truncatewords: 30 }}
              </p>
            </div>
            <div>
              <a href="{{ post.url | relative_url }}" class="btn btn-primary btn-sm">Read</a>
            </div>
          </div>
        </article>
      {% endfor %}
    </div>

    <!-- Timeline View -->
    <div id="timeline-posts" class="hidden">
      {% assign posts_by_year = posts_to_show | group_by_exp: 'post', 'post.date | date: "%Y"' %}
      {% for year in posts_by_year %}
        <div class="mb-12">
          <h2 class="text-2xl font-bold text-accent mb-6 sticky top-20 bg-base-100 py-2">{{ year.name }}</h2>
          <div class="timeline timeline-snap-icon timeline-compact timeline-vertical">
            {% for post in year.items %}
              <div class="timeline-item" 
                   data-post 
                   data-categories="{% if post.category %}{{ post.category | slugify }}{% endif %}"
                   data-tags="{% for tag in post.tags %}{{ tag | slugify }}{% unless forloop.last %} {% endunless %}{% endfor %}">
                <div class="timeline-middle">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-primary">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.236 4.53L8.93 10.7a.75.75 0 00-1.06 1.061l1.884 1.884a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" />
                  </svg>
                </div>
                <div class="timeline-start timeline-box mb-10 bg-base-200">
                  <time class="font-mono text-sm text-base-content/60">{{ post.date | date: "%b %d" }}</time>
                  <div class="text-lg font-bold">
                    <a href="{{ post.url | relative_url }}" class="hover:text-primary transition-colors">
                      {{ post.title }}
                    </a>
                  </div>
                  <p class="text-sm text-base-content/80 mt-2">
                    {{ post.excerpt | default: post.content | strip_html | truncatewords: 25 }}
                  </p>
                  {% if post.tags and post.tags.size > 0 %}
                    <div class="flex flex-wrap gap-1 mt-2">
                      {% for tag in post.tags limit:3 %}
                        <span class="badge badge-primary badge-xs">{{ tag }}</span>
                      {% endfor %}
                    </div>
                  {% endif %}
                </div>
                <hr class="bg-primary">
              </div>
            {% endfor %}
          </div>
        </div>
      {% endfor %}
    </div>
  </div>

  <!-- Empty State -->
  {% if posts_to_show.size == 0 %}
  <div class="text-center py-16">
    <div class="text-6xl mb-4">📝</div>
    <h2 class="text-2xl font-bold text-base-content/60 mb-2">No posts found</h2>
    <p class="text-base-content/60">
      {% if page.archive_type %}
        No posts found for {{ page.archive_type }}: "{{ page.archive_value }}"
      {% else %}
        Check back soon for awesome content!
      {% endif %}
    </p>
  </div>
  {% endif %}

  <!-- Pagination -->
  {% if posts_to_show.size > page.posts_per_page %}
    <div class="flex justify-center mt-12">
      <div class="btn-group">
        <button class="btn btn-outline">«</button>
        <button class="btn btn-outline btn-active">1</button>
        <button class="btn btn-outline">2</button>
        <button class="btn btn-outline">3</button>
        <button class="btn btn-outline">»</button>
      </div>
    </div>
  {% endif %}

  <!-- Back to Home -->
  <div class="text-center mt-16">
    <a href="{{ '/' | relative_url }}" class="btn btn-outline btn-primary">
      <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
      </svg>
      Back to Home
    </a>
  </div>
</div>

<!-- Archive Layout JavaScript -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const gridView = document.getElementById('grid-view');
    const listView = document.getElementById('list-view');
    const timelineView = document.getElementById('timeline-view');
    
    const gridPosts = document.getElementById('grid-posts');
    const listPosts = document.getElementById('list-posts');
    const timelinePosts = document.getElementById('timeline-posts');

    function setActiveView(activeBtn, activeContent) {
      // Reset all buttons
      [gridView, listView, timelineView].forEach(btn => btn.classList.remove('btn-active'));
      // Reset all content areas
      [gridPosts, listPosts, timelinePosts].forEach(content => content.classList.add('hidden'));
      
      // Set active
      activeBtn.classList.add('btn-active');
      activeContent.classList.remove('hidden');
      
      // Save preference
      localStorage.setItem('archive-view', activeBtn.id);
    }

    // Event listeners
    gridView.addEventListener('click', () => setActiveView(gridView, gridPosts));
    listView.addEventListener('click', () => setActiveView(listView, listPosts));
    timelineView.addEventListener('click', () => setActiveView(timelineView, timelinePosts));

    // Load saved preference
    const savedView = localStorage.getItem('archive-view');
    if (savedView === 'list-view') {
      setActiveView(listView, listPosts);
    } else if (savedView === 'timeline-view') {
      setActiveView(timelineView, timelinePosts);
    } else {
      setActiveView(gridView, gridPosts);
    }

    // Handle URL parameter filtering
    const urlParams = new URLSearchParams(window.location.search);
    const categoryFilter = urlParams.get('category');
    const tagFilter = urlParams.get('tag');

    if (categoryFilter || tagFilter) {
      // Filter posts based on URL parameters
      filterPosts(categoryFilter, tagFilter);
    }

    function filterPosts(category, tag) {
      const allPosts = document.querySelectorAll('[data-post]');
      
      allPosts.forEach(post => {
        const postCategories = post.getAttribute('data-categories') || '';
        const postTags = post.getAttribute('data-tags') || '';
        
        let shouldShow = true;
        
        if (category && !postCategories.toLowerCase().includes(category.toLowerCase())) {
          shouldShow = false;
        }
        
        if (tag && !postTags.toLowerCase().includes(tag.toLowerCase())) {
          shouldShow = false;
        }
        
        post.style.display = shouldShow ? 'block' : 'none';
      });
      
      // Update page title to show current filter
      const pageTitle = document.querySelector('h1');
      if (category) {
        pageTitle.textContent = `Posts in Category: ${category.replace('-', ' ')}`;
      } else if (tag) {
        pageTitle.textContent = `Posts tagged: ${tag.replace('-', ' ')}`;
      }
    }
  });
</script>